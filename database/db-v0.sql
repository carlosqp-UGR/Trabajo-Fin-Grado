CREATE DATABASE IF NOT EXISTS gestion_ansada;
CREATE USER 'app-user'@'%' IDENTIFIED BY 'app-passwd';
GRANT SELECT, INSERT, UPDATE, DELETE, EXECUTE, SHOW VIEW, CREATE TEMPORARY TABLES ON gestion_ansada.* TO 'app-user'@'%';
FLUSH PRIVILEGES;

USE gestion_ansada;

DROP TABLE IF EXISTS usuario;
CREATE TABLE IF NOT EXISTS usuario (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) NOT NULL UNIQUE,
    password VARCHAR(60) NOT NULL,
    fullname VARCHAR(100) NOT NULL,
    admin BOOLEAN DEFAULT false
);

-- admin, admin
-- usuario, passwd
INSERT INTO usuario (username, fullname, password, admin) VALUES
('admin', 'Administrador del Sistema', '$2a$10$CfEtffpicdmMTC1eYkvO8enZq369bI5asx0PWpfAgFy5tKSfB4K4W', true),
('usuario', 'Usuario Genérico', '$2a$10$FuhprCQvcNuXM/aVxORvYeYXe9ze5SYAX4BIcNBxkW787FnHlU9Rm', false);

DROP TABLE IF EXISTS `cliente`;
CREATE TABLE `cliente` (
  `id` int NOT NULL AUTO_INCREMENT,
  `nombre` varchar(80) NOT NULL,
  `direccion` text,
  `cif` varchar(20) DEFAULT NULL,
  `vat` varchar(20) DEFAULT NULL,
  `pais` varchar(80) DEFAULT NULL,
  `telefono` varchar(20) DEFAULT NULL,
  `email` varchar(255) DEFAULT NULL,
  `fax` varchar(20) DEFAULT NULL,
  `tipo` varchar(20) NOT NULL,
  `observaciones` text,
  PRIMARY KEY (`id`),
  UNIQUE KEY `nombre` (`nombre`)
);

LOCK TABLES `cliente` WRITE;
INSERT INTO `cliente` VALUES 
(1, 'EL COLORAO', 'CALLE PRINCIPAL 45\nSEVILLA, ESPAÑA', 'CIF99911122', 'VAT99911122', 'ESPAÑA', '954111223', 'INFO@ELCOLORAO.ES', '954111224', 'OTRO', 'EMPRESA DE ALQUILER DE MAQUINARIA LOCAL.'),
(2, 'TAXIS SEVILLA', 'AVENIDA DE LA CONSTITUCIÓN 34\nSEVILLA, ESPAÑA', 'CIF88822233', 'VAT88822233', 'ESPAÑA', '954222334', 'CONTACTO@TAXISSEVILLA.ES', '954222335', 'OTRO', 'SERVICIO LOCAL DE TAXIS EN SEVILLA.'),
(3, 'CANTERA DE YESO S.L.', 'CAMINO DE LAS CANTERAS S/N\nALMERÍA, ESPAÑA', 'CIF12345678A', 'VAT12345678A', 'ESPAÑA', '950123456', 'INFO@CANTERADEYESO.ES', '950123457', 'CARGADOR', 'EXPORTADOR DE YESO DESDE ALMERÍA.'),
(4, 'MINERALES DE ALMERÍA S.A.', 'CALLE MINAS 22\nALMERÍA, ESPAÑA', 'CIF12345678B', 'VAT12345678B', 'ESPAÑA', '950234567', 'INFO@MINERALESALMERIA.ES', '950234568', 'CARGADOR', 'EXPORTADOR DE MINERALES DESDE ALMERÍA.'),
(5, 'YESO Y MINERALES S.L.', 'AVENIDA DE LA MINERÍA 14\nGRANADA, ESPAÑA', 'CIF12345678C', 'VAT12345678C', 'ESPAÑA', '958123456', 'CONTACTO@YESOYMINERALES.ES', '958123457', 'CARGADOR', 'EXPORTADOR DE YESO DESDE GRANADA.'),
(6, 'MINAS DE YESO S.A.', 'CALLE DEL MINERAL 5\nALICANTE, ESPAÑA', 'CIF12345678D', 'VAT12345678D', 'ESPAÑA', '965123456', 'INFO@MINASDEYESO.ES', '965123457', 'CARGADOR', 'EXPORTADOR DE YESO DESDE ALICANTE.'),
(7, 'YESOS DEL SUR S.L.', 'CARRETERA DE LAS CANTERAS 3\nMÁLAGA, ESPAÑA', 'CIF12345678E', 'VAT12345678E', 'ESPAÑA', '952123456', 'INFO@YESOSDELSUR.ES', '952123457', 'CARGADOR', 'EXPORTADOR DE YESO DESDE MÁLAGA.'),
(8, 'YESO IBERICO S.L.', 'PASEO DE LA MINA 7\nMURCIA, ESPAÑA', 'CIF12345678F', 'VAT12345678F', 'ESPAÑA', '968123456', 'INFO@YESOIBERICO.ES', '968123457', 'CARGADOR', 'EXPORTADOR DE YESO DESDE MURCIA.'),
(9, 'ATLANTIC SHIPPING LTD.', '123 OCEAN AVENUE\nNEW YORK, USA', 'CIF87654321', 'VAT87654321', 'USA', '123456789', 'CONTACT@ATLANTICSHIPPING.COM', '123456780', 'ARMADOR', 'EMPRESA DE TRANSPORTE MARÍTIMO CON SEDE EN EE.UU.'),
(10, 'BALTIC MINERALS LLC', 'RED SQUARE 5\nMOSCÚ, RUSIA', 'CIF56473829', 'VAT56473829', 'RUSIA', '4951234567', 'INFO@BALTICMINERALS.RU', '4951234568', 'ARMADOR', 'EXPORTADOR DE MINERALES DESDE RUSIA.'),
(11, 'EUROPEAN CARGO SERVICES', 'EUROPA STRASSE 123\nBERLÍN, ALEMANIA', 'CIF98765432', 'VAT98765432', 'ALEMANIA', '49123456789', 'CONTACT@EUROPEANCARGO.DE', '49123456780', 'ARMADOR', 'SERVICIOS DE CARGA EN EUROPA.'),
(12, 'PACIFIC MINERALS INC.', 'PACIFIC ROAD 456\nTOKYO, JAPÓN', 'CIF23456789', 'VAT23456789', 'JAPÓN', '8131234567', 'INFO@PACIFICMINERALS.CO.JP', '8131234568', 'ARMADOR', 'EXPORTADOR DE MINERALES DESDE JAPÓN.'),
(13, 'GLOBAL SHIPPING CO.', 'WORLD TRADE CENTER 789\nLONDRES, REINO UNIDO', 'CIF34567890', 'VAT34567890', 'REINO UNIDO', '44201234567', 'CONTACT@GLOBALSHIPPING.CO.UK', '44201234568', 'ARMADOR', 'EMPRESA DE TRANSPORTE MARÍTIMO GLOBAL.'),
(14, 'MINERALES ANDES S.A.', 'CALLE LARGA 45\nLIMA, PERÚ', 'CIF12349876', 'VAT12349876', 'PERÚ', '51112345678', 'INFO@MINERALESANDES.PE', '51112345679', 'ARMADOR', 'EXPORTADOR DE MINERALES DESDE PERÚ.'),
(15, 'ASIA FREIGHTERS LTD.', 'ASIA PLAZA 101\nHONG KONG', 'CIF45678901', 'VAT45678901', 'HONG KONG', '85212345678', 'CONTACT@ASIAFREIGHTERS.HK', '85212345679', 'ARMADOR', 'EMPRESA DE TRANSPORTE MARÍTIMO EN ASIA.'),
(16, 'NORTH SEA SHIPPING', 'NORDVEJ 23\nOSLO, NORUEGA', 'CIF67890123', 'VAT67890123', 'NORUEGA', '4721234567', 'INFO@NORTHSEASHIPPING.NO', '4721234568', 'ARMADOR', 'TRANSPORTE MARÍTIMO EN EL MAR DEL NORTE.'),
(17, 'MEDITERRANEAN SHIPPING CO.', 'VIA DEL MARE 10\nGENOVA, ITALIA', 'CIF05678901', 'VAT05678901', 'ITALIA', '39012345678', 'CONTACT@MEDITERRANEANSHIPPING.IT', '39012345679', 'ARMADOR', 'EMPRESA DE TRANSPORTE MARÍTIMO EN EL MEDITERRÁNEO.'),
(18, 'TRANSOCEANIC SHIPPING', 'PORT STREET 120\nSINGAPUR', 'CIF01234567', 'VAT01234567', 'SINGAPUR', '65612345678', 'CONTACT@TRANSOCEANIC.SG', '65612345679', 'ARMADOR', 'EMPRESA DE TRANSPORTE MARÍTIMO EN SINGAPUR.'),
(19, 'INDIAN OCEAN CARGO', 'MARINE DRIVE 50\nMUMBAI, INDIA', 'CIF06789012', 'VAT06789012', 'INDIA', '912312345678', 'CONTACT@INDIANOCEANCARGO.IN', '912312345679', 'ARMADOR', 'SERVICIOS DE CARGA EN EL OCÉANO ÍNDICO.'),
(20, 'AFRICAN MINERALS CO.', 'SAFARI LANE 15\nCAPE TOWN, SUDÁFRICA', 'CIF90123456', 'VAT90123456', 'SUDÁFRICA', '27112345678', 'CONTACT@AFRICANMINERALS.CO.ZA', '27112345679', 'ARMADOR', 'EXPORTADOR DE MINERALES DESDE SUDÁFRICA.'),
(21, 'ARABIAN MINERALS LLC', 'KING FAISAL ROAD\nDUBAI, UAE', 'CIF03456789', 'VAT03456789', 'EMIRATOS ÁRABES UNIDOS', '97112345678', 'INFO@ARABIANMINERALS.AE', '97112345679', 'ARMADOR', 'EXPORTADOR DE MINERALES DESDE LOS EMIRATOS.');
UNLOCK TABLES;

DROP TABLE IF EXISTS `buque`;
CREATE TABLE `buque` (
  `id` int NOT NULL AUTO_INCREMENT,
  `nombre` varchar(80) NOT NULL,
  `bandera` varchar(80) DEFAULT NULL,
  `matricula` varchar(25) DEFAULT NULL,
  `trb` decimal(10,2) DEFAULT NULL,
  `eslora` decimal(10,2) DEFAULT NULL,
  `calado` decimal(10,2) DEFAULT NULL,
  `manga` decimal(10,2) DEFAULT NULL,
  `observaciones` text,
  `trn` decimal(10,2) DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `nombre` (`nombre`)
) ;

LOCK TABLES `buque` WRITE;
INSERT INTO `buque` VALUES 
(1,'ABU AL ABYAD','LIBERIA','MONROVIA',33202.00,190.00,13.57,32.26,NULL,23241.40),
(2,'ADAMOON','LIBERIA','MONROVIA',13579.00,149.96,10.00,23.60,NULL,9505.30),
(3,'AFRICAN VENTURE','HONG KONG','HONG KONG',24212.00,180.00,10.00,28.00,NULL,16948.40),
(4,'AGGELIKI B ','ISLAS MARSHALL ','MAJURO ',32987.00,189.90,11.00,32.26,NULL,23090.90),
(5,'AGIA DOXA','LIBERIA','MONROVIA',21650.00,178.90,10.00,21.00,NULL,15155.00),
(6,'AGIOS NIKOLAS','ISLAS MARSHALL','MAJURO',32360.00,189.90,12.00,32.26,NULL,22652.00),
(7,'AL YASAT II','LIBERIA','MONROVIA',33202.00,190.00,13.00,32.26,NULL,23241.40),
(8,'AMFITRITI','GRIEGA','PIRAEUS',34374.00,196.00,13.02,32.26,NULL,24061.80),
(9,'AMIS ELEGANCE','PANAMA ','PANAMA ',31557.00,189.90,12.00,32.26,NULL,22089.90),
(10,'AMIS GLORY','PANAMA ','PANAMA ',31557.00,189.99,11.00,32.26,NULL,22089.90),
(11,'AMIS LEADER','PANAMA ','PANAMA ',32315.00,189.99,10.00,30.26,NULL,22620.50),
(12,'AMIS POWER','PANAMEÑA','PANAMÁ',35607.00,199.90,13.33,32.26,NULL,24924.90),
(13,'AMORGOS BOLTEN ','PORTUGAL','MADEIRA',24247.00,180.00,10.30,30.00,NULL,16972.90),
(14,'AN CHANG','CHINA','GUANGZHOU',30963.00,185.00,12.52,32.26,NULL,21674.10),
(15,'ANTIGONI B','ISLAS MARSHALL','MAJURO',32983.00,189.90,12.80,32.26,NULL,23088.10),
(16,'ANTWERP EAGLE','ISLAS MARSHALL','MAJURO',36474.00,199.90,13.28,32.26,NULL,25532.20),
(17,'APOLLO BULKER','PANAMEÑA','PANAMÁ',21483.00,177.00,10.34,28.60,NULL,15038.10),
(18,'AQUARIUS','LITUANA','KLAIPEDA',1141.00,81.45,3.15,9.46,NULL,798.70),
(19,'ARGO','ANTIGUA','ST.JOHN´S',5630.00,108.20,7.27,18.20,NULL,3941.00),
(20,'ARKLOW CADET','IRLANDA','ARKLOW',2999.00,87.40,4.20,14.99,NULL,2099.30),
(21,'ARKLOW CLIPPER ','IRLANDA','ARKLOW ',2999.00,87.40,8.00,17.00,NULL,2099.30),
(22,'ARKLOW CLOUD ','IRLANDA','ARKLOW',2999.00,86.80,6.15,14.00,NULL,2099.30),
(23,'ARKLOW COAST','IRLANDA','ARKLOW',2999.00,87.40,6.14,14.99,NULL,2099.30),
(24,'ARKLOW FIELD','IRLANDA','ARKLOW',2998.00,89.95,6.28,14.50,NULL,2098.60),
(25,'ARKLOW FLAIR','IRLANDA ','ARKLOW',2998.00,89.95,6.28,14.40,NULL,2098.60),
(26,'ARKLOW MANOR','IRLANDA','ARKLOW',9758.00,136.50,9.00,21.00,NULL,6830.60),
(27,'ARKLOW VENTURE','HOLANDESA','ROTTERDAM',2999.00,86.93,6.35,15.00,NULL,2099.30),
(28,'ARKLOW VIEW','HOLANDESA','ROTTERDAM ',2999.00,86.90,6.20,17.00,NULL,2099.30),
(29,'ARUNA BERK','ISLAS MARSHALL','MAJURO',31901.00,193.07,13.02,32.26,NULL,22330.70),
(30,'ATALAYA TMA','ESPAÑOLA','S.C.TENERIFE',5132.00,118.00,6.54,15.90,NULL,3592.40),
(31,'AYR','LUXEMBURGO','LUXEMBURGO',2451.00,88.30,5.80,12.40,NULL,1715.70),
(32,'BALTIC HORNET ','ISLAS MARSHALL ','MAJURO ',36353.00,199.99,12.00,32.26,NULL,25447.10),
(33,'BEAUMAGIC','HOLANDESA','ROTTERDAM ',2545.00,88.60,5.20,17.80,NULL,1781.50),
(34,'BELASITZA','MALTA','VALLETTA',19906.00,186.00,10.42,23.70,NULL,13934.20),
(35,'BELFRIEND','NORUEGA','OSLO',32372.00,189.99,12.83,32.26,NULL,22660.40),
(36,'BOLTEN SYMI','ISLAS MARSHALL','MAJURO',15861.00,157.23,9.38,26.80,NULL,11102.70),
(37,'BREB XIAN','CHIPRE ','LIMASSOL',4115.00,100.50,8.00,15.50,NULL,2880.50),
(38,'BREMER ELENA','ALEMANA','HAMBURG',3172.00,89.98,5.31,15.20,NULL,2220.40),
(39,'BRETS CUXHAVEN','MADEIRA','FUNCHAL',5630.00,108.17,7.01,18.20,NULL,3941.00),
(40,'BULK ATACAMA','PANAMEÑA','PANAMÁ',34801.00,189.98,12.74,32.24,NULL,24360.70);
UNLOCK TABLES;

DROP TABLE IF EXISTS `estancia_de_buque`;
CREATE TABLE `estancia_de_buque` (
  `id` int NOT NULL AUTO_INCREMENT,
  `numero` varchar(7) NOT NULL,
  `t2l` varchar(50) DEFAULT NULL,
  `dua` varchar(50) DEFAULT NULL,
  `entrada` date DEFAULT NULL,
  `salida` date DEFAULT NULL,
  `carga` decimal(10,2) DEFAULT '0.00',
  `material` varchar(50) NOT NULL DEFAULT 'yeso',
  `cargador_id` int DEFAULT NULL,
  `buque_id` int NOT NULL,
  `capitan` varchar(100) DEFAULT NULL,
  `armador_id` int NOT NULL,
  `origen` varchar(50) DEFAULT NULL,
  `destino` varchar(50) DEFAULT NULL,
  `puerto` varchar(50) NOT NULL DEFAULT 'garrucha',
  `arrival_on_the_road` datetime DEFAULT NULL,
  `entrada_fondeadero` datetime DEFAULT NULL,
  `salida_fondeadero` datetime DEFAULT NULL,
  `atraque_puerto` datetime DEFAULT NULL,
  `inicio_carga` datetime DEFAULT NULL,
  `fin_carga` datetime DEFAULT NULL,
  `salida_puerto` datetime DEFAULT NULL,
  `observaciones` text,
  PRIMARY KEY (`id`),
  UNIQUE KEY `numero` (`numero`),
  KEY `cargador_id` (`cargador_id`),
  KEY `armador_id` (`armador_id`),
  KEY `buque_id` (`buque_id`),
  CONSTRAINT `estancia_de_buque_ibfk_1` FOREIGN KEY (`cargador_id`) REFERENCES `cliente` (`id`) ON DELETE RESTRICT,
  CONSTRAINT `estancia_de_buque_ibfk_2` FOREIGN KEY (`armador_id`) REFERENCES `cliente` (`id`) ON DELETE RESTRICT,
  CONSTRAINT `estancia_de_buque_ibfk_3` FOREIGN KEY (`buque_id`) REFERENCES `buque` (`id`) ON DELETE RESTRICT
);


-- 3-8 Cargadores 9-21 armadores
LOCK TABLES `estancia_de_buque` WRITE;
INSERT INTO `estancia_de_buque` (`numero`, `t2l`, `dua`, `entrada`, `salida`, `carga`, `material`, `cargador_id`, `buque_id`, `capitan`, `armador_id`, `origen`, `destino`, `puerto`, `arrival_on_the_road`, `entrada_fondeadero`, `salida_fondeadero`, `atraque_puerto`, `inicio_carga`, `fin_carga`, `salida_puerto`, `observaciones`) VALUES
('1/24', '123456', '654321', '2024-06-01', '2024-06-03', 23241.40, 'YESO', 4, 1, 'JOHN DOE', 9, 'ALMERÍA', 'LONDRES', 'GARRUCHA', '2024-06-01 08:00:00', '2024-06-01 09:00:00', '2024-06-01 10:00:00', '2024-06-01 11:00:00', '2024-06-01 12:00:00', '2024-06-02 12:00:00', '2024-06-03 08:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('2/24', '234567', '765432', '2024-06-02', '2024-06-04', 9505.30, 'YESO', 5, 2, 'JANE SMITH', 10, 'VALENCIA', 'AMSTERDAM', 'GARRUCHA', '2024-06-02 09:00:00', '2024-06-02 10:00:00', '2024-06-02 11:00:00', '2024-06-02 12:00:00', '2024-06-02 13:00:00', '2024-06-03 13:00:00', '2024-06-04 09:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('3/24', '345678', '876543', '2024-06-03', '2024-06-05', 16948.40, 'YESO', 6, 3, 'MICHAEL BROWN', 11, 'BARCELONA', 'ROTTERDAM', 'GARRUCHA', '2024-06-03 10:00:00', '2024-06-03 11:00:00', '2024-06-03 12:00:00', '2024-06-03 13:00:00', '2024-06-03 14:00:00', '2024-06-04 14:00:00', '2024-06-05 10:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('4/24', '456789', '987654', '2024-06-04', '2024-06-06', 23090.90, 'YESO', 4, 4, 'LAURA JOHNSON', 12, 'SEVILLA', 'HAMBURGO', 'GARRUCHA', '2024-06-04 11:00:00', '2024-06-04 12:00:00', '2024-06-04 13:00:00', '2024-06-04 14:00:00', '2024-06-04 15:00:00', '2024-06-05 15:00:00', '2024-06-06 11:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('5/24', '567890', '098765', '2024-06-05', '2024-06-07', 15155.00, 'YESO', 7, 5, 'JAMES DAVIS', 13, 'CÁDIZ', 'DUBLÍN', 'GARRUCHA', '2024-06-05 12:00:00', '2024-06-05 13:00:00', '2024-06-05 14:00:00', '2024-06-05 15:00:00', '2024-06-05 16:00:00', '2024-06-06 16:00:00', '2024-06-07 12:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('6/24', '678901', '109876', '2024-06-06', '2024-06-08', 22652.00, 'YESO', 8, 6, 'ROBERT WILSON', 14, 'MÁLAGA', 'GÉNOVA', 'CARBONERAS', '2024-06-06 13:00:00', '2024-06-06 14:00:00', '2024-06-06 15:00:00', '2024-06-06 16:00:00', '2024-06-06 17:00:00', '2024-06-07 17:00:00', '2024-06-08 13:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('7/24', '789012', '210987', '2024-06-07', '2024-06-09', 23241.40, 'YESO', 4, 7, 'DAVID MARTINEZ', 15, 'ALICANTE', 'OSLO', 'CARBONERAS', '2024-06-07 14:00:00', '2024-06-07 15:00:00', '2024-06-07 16:00:00', '2024-06-07 17:00:00', '2024-06-07 18:00:00', '2024-06-08 18:00:00', '2024-06-09 14:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('8/24', '890123', '321098', '2024-06-08', '2024-06-10', 24061.80, 'YESO', 4, 8, 'MARIA GARCIA', 16, 'CARTAGENA', 'ANTWERP', 'GARRUCHA', '2024-06-08 15:00:00', '2024-06-08 16:00:00', '2024-06-08 17:00:00', '2024-06-08 18:00:00', '2024-06-08 19:00:00', '2024-06-09 19:00:00', '2024-06-10 15:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('9/24', '901234', '432109', '2024-06-09', '2024-06-11', 22089.90, 'YESO', 5, 9, 'JUAN RODRIGUEZ', 17, 'TARRAGONA', 'COPENHAGEN', 'GARRUCHA', '2024-06-09 08:00:00', '2024-06-09 09:00:00', '2024-06-09 10:00:00', '2024-06-09 11:00:00', '2024-06-09 12:00:00', '2024-06-10 12:00:00', '2024-06-11 08:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('10/24', '012345', '543210', '2024-06-10', '2024-06-12', 22089.90, 'YESO', 6, 10, 'PEDRO HERNANDEZ', 18, 'SAGUNTO', 'HELSINKI', 'GARRUCHA', '2024-06-10 09:00:00', '2024-06-10 10:00:00', '2024-06-10 11:00:00', '2024-06-10 12:00:00', '2024-06-10 13:00:00', '2024-06-11 13:00:00', '2024-06-12 09:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('11/24', '123456', '654321', '2024-06-11', '2024-06-13', 22620.50, 'YESO', 4, 11, 'ALBERTO LOPEZ', 19, 'VIGO', 'BERGEN', 'GARRUCHA', '2024-06-11 10:00:00', '2024-06-11 11:00:00', '2024-06-11 12:00:00', '2024-06-11 13:00:00', '2024-06-11 14:00:00', '2024-06-12 14:00:00', '2024-06-13 10:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('12/24', '234567', '765432', '2024-06-12', '2024-06-14', 24924.90, 'YESO', 5, 12, 'MIGUEL GOMEZ', 20, 'SANTANDER', 'GÖTEBORG', 'GARRUCHA', '2024-06-12 11:00:00', '2024-06-12 12:00:00', '2024-06-12 13:00:00', '2024-06-12 14:00:00', '2024-06-12 15:00:00', '2024-06-13 15:00:00', '2024-06-14 11:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('13/24', '345678', '876543', '2024-06-13', '2024-06-15', 16972.90, 'YESO', 6, 13, 'CARLOS FERNANDEZ', 21, 'BILBAO', 'STOCKHOLM', 'GARRUCHA', '2024-06-13 12:00:00', '2024-06-13 13:00:00', '2024-06-13 14:00:00', '2024-06-13 15:00:00', '2024-06-13 16:00:00', '2024-06-14 16:00:00', '2024-06-15 12:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('14/24', '456789', '987654', '2024-06-14', '2024-06-16', 23088.10, 'YESO', 4, 15, 'RAUL MARTIN', 9, 'GIJÓN', 'TALLINN', 'GARRUCHA', '2024-06-14 13:00:00', '2024-06-14 14:00:00', '2024-06-14 15:00:00', '2024-06-14 16:00:00', '2024-06-14 17:00:00', '2024-06-15 17:00:00', '2024-06-16 13:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('15/24', '567890', '098765', '2024-06-15', '2024-06-17', 25532.20, 'YESO', 5, 16, 'ANDREA LOPEZ', 10, 'FERROL', 'RIGA', 'GARRUCHA', '2024-06-15 14:00:00', '2024-06-15 15:00:00', '2024-06-15 16:00:00', '2024-06-15 17:00:00', '2024-06-15 18:00:00', '2024-06-16 18:00:00', '2024-06-17 14:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('16/24', '678901', '109876', '2024-06-16', '2024-06-18', 15038.10, 'YESO', 6, 17, 'MARTA GARCIA', 11, 'CARTAGENA', 'HELSINKI', 'GARRUCHA', '2024-06-16 08:00:00', '2024-06-16 09:00:00', '2024-06-16 10:00:00', '2024-06-16 11:00:00', '2024-06-16 12:00:00', '2024-06-17 12:00:00', '2024-06-18 08:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('17/24', '789012', '210987', '2024-06-17', '2024-06-19', 23241.40, 'YESO', 4, 18, 'SARA MARTINEZ', 12, 'ALMERÍA', 'GDAŃSK', 'GARRUCHA', '2024-06-17 09:00:00', '2024-06-17 10:00:00', '2024-06-17 11:00:00', '2024-06-17 12:00:00', '2024-06-17 13:00:00', '2024-06-18 13:00:00', '2024-06-19 09:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('18/24', '890123', '321098', '2024-06-18', '2024-06-20', 24061.80, 'YESO', 5, 19, 'LUIS PEREZ', 13, 'VALENCIA', 'TALLINN', 'GARRUCHA', '2024-06-18 10:00:00', '2024-06-18 11:00:00', '2024-06-18 12:00:00', '2024-06-18 13:00:00', '2024-06-18 14:00:00', '2024-06-19 14:00:00', '2024-06-20 10:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('19/24', '901234', '432109', '2024-06-19', '2024-06-21', 22089.90, 'YESO', 6, 20, 'ANA FERNANDEZ', 14, 'SEVILLA', 'OSLO', 'GARRUCHA', '2024-06-19 11:00:00', '2024-06-19 12:00:00', '2024-06-19 13:00:00', '2024-06-19 14:00:00', '2024-06-19 15:00:00', '2024-06-20 15:00:00', '2024-06-21 11:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('20/24', '012345', '543210', '2024-06-20', '2024-06-22', 22089.90, 'YESO', 4, 21, 'CARLOS HERNANDEZ', 15, 'MÁLAGA', 'BERGEN', 'GARRUCHA', '2024-06-20 12:00:00', '2024-06-20 13:00:00', '2024-06-20 14:00:00', '2024-06-20 15:00:00', '2024-06-20 16:00:00', '2024-06-21 16:00:00', '2024-06-22 12:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('21/24', '234567', '654321', '2024-06-21', '2024-06-23', 22620.50, 'YESO', 5, 11, 'PEDRO GONZALEZ', 9, 'SANTANDER', 'STOCKHOLM', 'GARRUCHA', '2024-06-21 08:00:00', '2024-06-21 09:00:00', '2024-06-21 10:00:00', '2024-06-21 11:00:00', '2024-06-21 12:00:00', '2024-06-22 12:00:00', '2024-06-23 08:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('22/24', '345678', '765432', '2024-06-22', '2024-06-24', 24924.90, 'YESO', 6, 12, 'JORGE MARTINEZ', 10, 'GIJÓN', 'HELSINKI', 'GARRUCHA', '2024-06-22 09:00:00', '2024-06-22 10:00:00', '2024-06-22 11:00:00', '2024-06-22 12:00:00', '2024-06-22 13:00:00', '2024-06-23 13:00:00', '2024-06-24 09:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('23/24', '456789', '876543', '2024-06-23', '2024-06-25', 16972.90, 'YESO', 4, 13, 'ANA RODRIGUEZ', 11, 'FERROL', 'RIGA', 'GARRUCHA', '2024-06-23 08:00:00', '2024-06-23 09:00:00', '2024-06-23 10:00:00', '2024-06-23 11:00:00', '2024-06-23 12:00:00', '2024-06-24 12:00:00', '2024-06-25 08:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('24/24', '567890', '987654', '2024-06-24', '2024-06-26', 22660.40, 'YESO', 5, 14, 'MARIO SANCHEZ', 12, 'CARTAGENA', 'OSLO', 'GARRUCHA', '2024-06-24 09:00:00', '2024-06-24 10:00:00', '2024-06-24 11:00:00', '2024-06-24 12:00:00', '2024-06-24 13:00:00', '2024-06-25 13:00:00', '2024-06-26 09:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('25/24', '678901', '098765', '2024-06-25', '2024-06-27', 11102.70, 'YESO', 6, 36, 'JUAN CARLOS', 13, 'ALMERÍA', 'GDAŃSK', 'CARBONERAS', '2024-06-25 08:00:00', '2024-06-25 09:00:00', '2024-06-25 10:00:00', '2024-06-25 11:00:00', '2024-06-25 12:00:00', '2024-06-26 12:00:00', '2024-06-27 08:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('26/24', '789012', '210987', '2024-06-26', '2024-06-28', 3941.00, 'YESO', 4, 19, 'CARLA MARTINEZ', 10, 'VALENCIA', 'TALLINN', 'CARBONERAS', '2024-06-26 09:00:00', '2024-06-26 10:00:00', '2024-06-26 11:00:00', '2024-06-26 12:00:00', '2024-06-26 13:00:00', '2024-06-27 13:00:00', '2024-06-28 09:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('27/24', '890123', '321098', '2024-06-27', '2024-06-29', 21674.10, 'YESO', 5, 14, 'RAUL GARCIA', 11, 'SANTANDER', 'STOCKHOLM', 'GARRUCHA', '2024-06-27 08:00:00', '2024-06-27 09:00:00', '2024-06-27 10:00:00', '2024-06-27 11:00:00', '2024-06-27 12:00:00', '2024-06-28 12:00:00', '2024-06-29 08:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('28/24', '901234', '432109', '2024-06-28', '2024-06-30', 23241.40, 'YESO', 6, 7, 'MARTA LOPEZ', 12, 'GIJÓN', 'HELSINKI', 'GARRUCHA', '2024-06-28 09:00:00', '2024-06-28 10:00:00', '2024-06-28 11:00:00', '2024-06-28 12:00:00', '2024-06-28 13:00:00', '2024-06-29 13:00:00', '2024-06-30 09:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('29/24', '012345', '543210', '2024-06-29', '2024-07-01', 22089.90, 'YESO', 4, 10, 'CARLOS GONZALEZ', 9, 'FERROL', 'RIGA', 'GARRUCHA', '2024-06-29 08:00:00', '2024-06-29 09:00:00', '2024-06-29 10:00:00', '2024-06-29 11:00:00', '2024-06-29 12:00:00', '2024-06-30 12:00:00', '2024-07-01 08:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.'),
('30/24', '123456', '654321', '2024-06-30', '2024-07-02', 23090.90, 'YESO', 5, 4, 'LUIS MARTINEZ', 10, 'CARTAGENA', 'OSLO', 'GARRUCHA', '2024-06-30 09:00:00', '2024-06-30 10:00:00', '2024-06-30 11:00:00', '2024-06-30 12:00:00', '2024-06-30 13:00:00', '2024-07-01 13:00:00', '2024-07-02 09:00:00', 'TIEMPO DESPEJADO, CARGA SIN INCIDENTES.');
UNLOCK TABLES;

DROP VIEW IF EXISTS vista_estancia_de_buque;
CREATE VIEW vista_estancia_de_buque AS
SELECT 
    edb.*,
    c1.nombre AS armador_nombre,
    c2.nombre AS cargador_nombre,
    b.nombre AS buque_nombre
FROM 
    estancia_de_buque edb
JOIN
    buque b ON edb.buque_id = b.id
JOIN
    cliente c1 ON edb.ARMADOR_id = c1.id
JOIN
    cliente c2 ON edb.CARGADOR_id = c2.id;

DROP TABLE IF EXISTS factura;
CREATE TABLE IF NOT EXISTS factura (
    id INT AUTO_INCREMENT PRIMARY KEY,
    num_factura VARCHAR(10) NOT NULL UNIQUE,
    tipo VARCHAR(3) NOT NULL,
    fecha DATE DEFAULT NULL,
    cliente_id INT NOT NULL,
    iva DECIMAL(10,2) DEFAULT 0,
    concepto1 VARCHAR(100) DEFAULT NULL,
    concepto2 VARCHAR(100) DEFAULT NULL,
    concepto3 VARCHAR(100) DEFAULT NULL,
    concepto4 VARCHAR(100) DEFAULT NULL,
    concepto5 VARCHAR(100) DEFAULT NULL,
    concepto6 VARCHAR(100) DEFAULT NULL,
    concepto7 VARCHAR(100) DEFAULT NULL,
    concepto8 VARCHAR(100) DEFAULT NULL,
    concepto9 VARCHAR(100) DEFAULT NULL,
    concepto10 VARCHAR(100) DEFAULT NULL,
    concepto11 VARCHAR(100) DEFAULT NULL,
    concepto12 VARCHAR(100) DEFAULT NULL,
    concepto13 VARCHAR(100) DEFAULT NULL,
    concepto14 VARCHAR(100) DEFAULT NULL,
    concepto15 VARCHAR(100) DEFAULT NULL,
    concepto16 VARCHAR(100) DEFAULT NULL,
    concepto17 VARCHAR(100) DEFAULT NULL,
    concepto18 VARCHAR(100) DEFAULT NULL,
    concepto19 VARCHAR(100) DEFAULT NULL,
    concepto20 VARCHAR(100) DEFAULT NULL,
    precio1 DECIMAL(10,2) DEFAULT NULL,
    precio2 DECIMAL(10,2) DEFAULT NULL,
    precio3 DECIMAL(10,2) DEFAULT NULL,
    precio4 DECIMAL(10,2) DEFAULT NULL,
    precio5 DECIMAL(10,2) DEFAULT NULL,
    precio6 DECIMAL(10,2) DEFAULT NULL,
    precio7 DECIMAL(10,2) DEFAULT NULL,
    precio8 DECIMAL(10,2) DEFAULT NULL,
    precio9 DECIMAL(10,2) DEFAULT NULL,
    precio10 DECIMAL(10,2) DEFAULT NULL,
    precio11 DECIMAL(10,2) DEFAULT NULL,
    precio12 DECIMAL(10,2) DEFAULT NULL,
    precio13 DECIMAL(10,2) DEFAULT NULL,
    precio14 DECIMAL(10,2) DEFAULT NULL,
    precio15 DECIMAL(10,2) DEFAULT NULL,
    precio16 DECIMAL(10,2) DEFAULT NULL,
    precio17 DECIMAL(10,2) DEFAULT NULL,
    precio18 DECIMAL(10,2) DEFAULT NULL,
    precio19 DECIMAL(10,2) DEFAULT NULL,
    precio20 DECIMAL(10,2) DEFAULT NULL,
    CONSTRAINT FK_FacturaCliente FOREIGN KEY(cliente_id) REFERENCES cliente(id) ON DELETE RESTRICT,
    CONSTRAINT CHK_TipoFactura CHECK(tipo IN ('A', 'B', 'C', 'AQH'))
);

CREATE TABLE IF NOT EXISTS factura_con_buque (
    id INT PRIMARY KEY, -- Herencia
    buque_id INT NOT NULL,
    fecha_entrada DATE DEFAULT NULL,
    fecha_salida DATE DEFAULT NULL,
    CONSTRAINT FK_FacturaID1 FOREIGN KEY (id) REFERENCES factura(id) ON DELETE CASCADE,
    CONSTRAINT FK_FacturaBuque FOREIGN KEY (buque_id) REFERENCES buque(id) ON DELETE RESTRICT
);

CREATE TABLE IF NOT EXISTS factura_con_dias (
    id INT PRIMARY KEY, -- Herencia
    dia1 INT UNSIGNED DEFAULT NULL,
    dia2 INT UNSIGNED DEFAULT NULL,
    dia3 INT UNSIGNED DEFAULT NULL,
    dia4 INT UNSIGNED DEFAULT NULL,
    dia5 INT UNSIGNED DEFAULT NULL,
    dia6 INT UNSIGNED DEFAULT NULL,
    dia7 INT UNSIGNED DEFAULT NULL,
    dia8 INT UNSIGNED DEFAULT NULL,
    dia9 INT UNSIGNED DEFAULT NULL,
    dia10 INT UNSIGNED DEFAULT NULL,
    dia11 INT UNSIGNED DEFAULT NULL,
    dia12 INT UNSIGNED DEFAULT NULL,
    dia13 INT UNSIGNED DEFAULT NULL,
    dia14 INT UNSIGNED DEFAULT NULL,
    dia15 INT UNSIGNED DEFAULT NULL,
    dia16 INT UNSIGNED DEFAULT NULL,
    dia17 INT UNSIGNED DEFAULT NULL,
    dia18 INT UNSIGNED DEFAULT NULL,
    dia19 INT UNSIGNED DEFAULT NULL,
    dia20 INT UNSIGNED DEFAULT NULL,
    CONSTRAINT FK_FacturaID2 FOREIGN KEY (id) REFERENCES factura(id) ON DELETE CASCADE
);

-- Facturas tipo A y B

LOCK TABLES `factura` WRITE;

INSERT INTO `factura` (`id`, `num_factura`, `tipo`, `fecha`, `cliente_id`, `iva`, `concepto1`, `precio1`, `concepto2`, `precio2`, `concepto3`, `precio3`, `concepto4`, `precio4`, `concepto5`, `precio5`) VALUES
(1, 'A1/24', 'A', '2024-06-05', 3, 21, 'MOORING', 500.00, 'PILOTAGE', 200.00, 'FRESH WATER', 300.00, 'WASTE COLLECTION', 150.00, 'CUSTOMS CLEARANCE', 250.00),
(2, 'A2/24', 'A', '2024-06-10', 4, 21, 'STEVEDORING', 800.00, 'HOTEL ACCOMMODATION', 400.00, 'LIGHT DUES', 600.00, NULL, NULL, NULL, NULL),
(3, 'A3/24', 'A', '2024-06-15', 5, 21, 'BUNKERING', 300.00, 'CLEANING OF HOLDS', 150.00, 'SUPPLIES', 250.00, NULL, NULL, NULL, NULL),
(4, 'A4/24', 'A', '2024-06-20', 6, 21, 'SURVEYING', 700.00, 'TUG SERVICES', 250.00, 'PORT DUES', 450.00, NULL, NULL, NULL, NULL),
(5, 'A5/24', 'A', '2024-06-25', 7, 21, 'LASHING', 1200.00, 'CHARTERING', 600.00, 'OPERATIVE SERVICES', 800.00, NULL, NULL, NULL, NULL),
(6, 'A6/24', 'A', '2024-06-08', 8, 21, 'CARGO HANDLING', 500.00, 'CONTAINER INSPECTION', 200.00, 'PORT AGENCY', 300.00, NULL, NULL, NULL, NULL),
(7, 'A7/24', 'A', '2024-06-13', 3, 21, 'DESPATCH', 1000.00, 'MARINE SERVICES', 300.00, NULL, NULL, NULL, NULL, NULL, NULL),
(8, 'A8/24', 'A', '2024-06-18', 4, 21, 'STOWAGE', 850.00, 'FRESH WATER', 200.00, 'WASTE DISPOSAL', 400.00, 'CUSTOMS', 300.00, NULL, NULL),
(9, 'A9/24', 'A', '2024-06-03', 5, 21, 'LIGHTHOUSE DUES', 700.00, 'TUG BOAT SERVICE', 300.00, 'PORT AGENCY', 450.00, NULL, NULL, NULL, NULL),
(10, 'A10/24', 'A', '2024-06-28', 6, 21, 'CHANDLERY', 950.00, 'SECURITY', 150.00, NULL, NULL, NULL, NULL, NULL, NULL);

INSERT INTO `factura` (`id`, `num_factura`, `tipo`, `fecha`, `cliente_id`, `iva`, `concepto1`, `precio1`, `concepto2`, `precio2`, `concepto3`, `precio3`, `concepto4`, `precio4`, `concepto5`, `precio5`) VALUES
(11, 'B1/24', 'B', '2024-06-07', 7, 21, 'PILOTAGE', 400.00, 'PORT CHARGES', 150.00, 'WASTE DISPOSAL', 200.00, NULL, NULL, NULL, NULL),
(12, 'B2/24', 'B', '2024-06-14', 8, 21, 'BUNKERING', 600.00, 'MARINE INSURANCE', 300.00, 'PORT AGENCY', 400.00, NULL, NULL, NULL, NULL),
(13, 'B3/24', 'B', '2024-06-21', 3, 21, 'MOORING', 350.00, 'SURVEYING', 200.00, NULL, NULL, NULL, NULL, NULL, NULL),
(14, 'B4/24', 'B', '2024-06-26', 4, 21, 'FUEL SUPPLY', 900.00, 'BROKERAGE', 250.00, NULL, NULL, NULL, NULL, NULL, NULL),
(15, 'B5/24', 'B', '2024-06-30', 5, 21, 'CARGO HANDLING', 750.00, 'CONTAINER INSPECTION', 150.00, 'FRESH WATER', 300.00, NULL, NULL, NULL, NULL);

UNLOCK TABLES;

LOCK TABLES `factura_con_buque` WRITE;

INSERT INTO `factura_con_buque` (`id`, `buque_id`, `fecha_entrada`, `fecha_salida`)
VALUES
(1, 12, '2024-06-05', '2024-06-06'),
(2, 26, '2024-06-08', '2024-06-09'),
(3, 8, '2024-06-10', '2024-06-11'),
(4, 17, '2024-06-12', '2024-06-13'),
(5, 4, '2024-06-15', '2024-06-16'),
(6, 33, '2024-06-18', '2024-06-19'),
(7, 22, '2024-06-20', '2024-06-21'),
(8, 10, '2024-06-23', '2024-06-24'),
(9, 7, '2024-06-25', '2024-06-26'),
(10, 39, '2024-06-28', '2024-06-29'),
(11, 15, '2024-06-02', '2024-06-03'),
(12, 29, '2024-06-04', '2024-06-05'),
(13, 1, '2024-06-06', '2024-06-07'),
(14, 20, '2024-06-08', '2024-06-09'),
(15, 36, '2024-06-10', '2024-06-11');

UNLOCK TABLES;

-- Facturas tipo C

LOCK TABLES `factura` WRITE;
INSERT INTO `factura` (`id`, `num_factura`, `tipo`, `fecha`, `cliente_id`, `iva`, `concepto1`, `precio1`, `concepto2`, `precio2`, `concepto3`, `precio3`, `concepto4`, `precio4`, `concepto5`, `precio5`)
VALUES
(16, 'C1/24', 'C', '2024-06-05', 3, 21, 'LOADING SERVICES', 1000.00, 'CRANE HIRE', 800.00, 'STORAGE', 500.00, 'CUSTOMS CLEARANCE', 300.00, 'FORKLIFT RENTAL', 400.00),
(17, 'C2/24', 'C', '2024-06-06', 4, 21, 'BULK CARGO HANDLING', 1200.00, 'CARGO INSPECTION', 600.00, 'DUST SUPPRESSION', 300.00, 'PORT SECURITY', 400.00, 'DOCUMENTATION', 250.00),
(18, 'C3/24', 'C', '2024-06-07', 5, 21, 'CONTAINER STUFFING', 900.00, 'WEIGHBRIDGE CHARGES', 400.00, 'LASHING AND SECURING', 500.00, 'CARGO LABELING', 200.00, 'STEVEDORING', 300.00),
(19, 'C4/24', 'C', '2024-06-08', 6, 21, 'PALLETIZING', 600.00, 'CARGO SURVEY', 700.00, 'PACKAGING', 400.00, 'FUMIGATION', 300.00, 'CARGO INSURANCE', 350.00),
(20, 'C5/24', 'C', '2024-06-09', 7, 21, 'LOAD PLANNING', 800.00, 'CONTAINER TRACKING', 300.00, 'CARGO SEALING', 400.00, 'BROKERAGE', 250.00, 'TRUCKING', 600.00),
(21, 'C6/24', 'C', '2024-06-10', 7, 12.5, 'REPACKING', 500.00, 'CARGO LABELING', 200.00, 'INSPECTION', 312.00, 'WEIGHING', 150.00, 'CONTAINER RENTAL', 400.50),
(22, 'C7/24', 'C', '2024-06-11', 3, 21, 'LOADING EQUIPMENT', 700.00, 'DOCKING SERVICES', 400.00, 'STORAGE RENTAL', 300.00, 'HAZARDOUS MATERIALS HANDLING', 350.00, 'PACKAGING MATERIALS', 200.00),
(23, 'C8/24', 'C', '2024-06-12', 7, 21, 'CRANE RENTAL', 1000.00, 'LOADING SUPERVISION', 500.00, 'TRANSIT DOCUMENTS', 250.00, 'SECURITY ESCORT', 300.00, 'LOGISTICS CONSULTING', 450.00),
(24, 'C9/24', 'C', '2024-06-13', 5, 21, 'FORKLIFT OPERATOR', 600.00, 'CARGO SORTING', 400.00, 'PACKING MATERIALS', 200.00, 'EXPORT DOCUMENTATION', 300.00, 'TRANSPORT ARRANGEMENTS', 700.00),
(25, 'C10/24', 'C', '2024-06-14', 6, 21, 'DOCKING FEES', 800.00, 'CARGO SECURING', 300.00, 'LIFTING EQUIPMENT RENTAL', 400.00, 'CUSTOMS BROKERAGE', 250.00, 'LOADING SERVICES', 500.00);
UNLOCK TABLES;

LOCK TABLES `factura_con_dias` WRITE;
INSERT INTO `factura_con_dias` (`id`, `dia1`, `dia2`, `dia3`, `dia4`, `dia5`) VALUES
(16, 5, 3, 2, NULL, 4),
(17, NULL, 1, 2, 3, 5),
(18, 4, 5, NULL, NULL, 2),
(19, 1, 2, 3, 4, NULL),
(20, 3, NULL, 4, 5, 2),
(21, 2, 4, 5, 1, NULL),
(22, 5, 3, 1, NULL, 4),
(23, NULL, 2, 1, 5, 3),
(24, 4, 5, NULL, 2, 1),
(25, 1, 2, 3, 4, NULL);
UNLOCK TABLES;

-- Facturas tipo AQH

LOCK TABLES `factura` WRITE;
INSERT INTO `factura` (`id`, `num_factura`, `tipo`, `fecha`, `cliente_id`, `iva`, `concepto1`, `precio1`, `concepto2`, `precio2`, `concepto3`, `precio3`, `concepto4`, `precio4`, `concepto5`, `precio5`)
VALUES
(26, 'AQH1/24', 'AQH', '2024-06-01', 10, 21, 'OPERATIONAL SUPPORT', 800.00, 'PORT FEES', 300.00, 'SUPPLY SERVICES', 400.00, 'VESSEL MAINTENANCE', 500.00, 'NAVIGATION EQUIPMENT', 600.00),
(27, 'AQH2/24', 'AQH', '2024-06-02', 15, 21, 'CREW SALARIES', 1200.00, 'PORT SECURITY', 500.00, 'CLEANING SERVICES', 300.00, 'FRESH PROVISIONS', 400.00, 'REPAIRS AND MAINTENANCE', 600.00),
(28, 'AQH3/24', 'AQH', '2024-06-03', 20, 21, 'MARITIME INSURANCE', 1500.00, 'PASSENGER HANDLING', 400.00, 'COMMUNICATIONS', 200.00, 'CUSTOMS DECLARATIONS', 300.00, 'CARGO CLAIMS', 700.00),
(29, 'AQH4/24', 'AQH', '2024-06-04', 5, 21, 'PORT TOWAGE', 1000.00, 'SUPPLY CHAIN MANAGEMENT', 600.00, 'WAREHOUSE FACILITIES', 400.00, 'SURVEILLANCE SERVICES', 300.00, 'EMERGENCY RESPONSE', 500.00),
(30, 'AQH5/24', 'AQH', '2024-06-05', 8, 21, 'CARGO HANDLING EQUIPMENT', 900.00, 'VESSEL AGENCY SERVICES', 300.00, 'BERTHING FACILITIES', 500.00, 'FUEL SUPPLY', 200.00, 'INVENTORY MANAGEMENT', 400.00),
(31, 'AQH6/24', 'AQH', '2024-06-06', 12, 21, 'DRY DOCKING', 1400.00, 'CREW CHANGE', 700.00, 'NAVIGATIONAL CHARTS', 400.00, 'VISA PROCESSING', 300.00, 'CARGO SUPERVISION', 600.00),
(32, 'AQH7/24', 'AQH', '2024-06-07', 18, 21, 'VESSEL CHARTERING', 1600.00, 'TUG ASSISTANCE', 500.00, 'ANCHORAGE', 300.00, 'VESSEL SURVEY', 400.00, 'PORT CLEARANCE', 700.00),
(33, 'AQH8/24', 'AQH', '2024-06-08', 3, 21, 'SHIP REPAIRS', 1100.00, 'EMBARKATION SERVICES', 400.00, 'PROVISIONING', 300.00, 'SATELLITE COMMUNICATIONS', 200.00, 'CUSTOMS BROKERAGE', 500.00),
(34, 'AQH9/24', 'AQH', '2024-06-09', 7, 21, 'VISA SERVICES', 1300.00, 'VESSEL INSPECTION', 600.00, 'ANCHORAGE FEES', 400.00, 'CARGO STORAGE', 300.00, 'CREW TRAINING', 500.00),
(35, 'AQH10/24', 'AQH', '2024-06-10', 16, 21, 'PORT OPERATIONS', 1200.00, 'CUSTOMS SUPPORT', 500.00, 'SUPPLY CHAIN SECURITY', 300.00, 'SHIP CHANDLING', 400.00, 'ENVIRONMENTAL COMPLIANCE', 600.00);
UNLOCK TABLES;

DROP VIEW IF EXISTS vista_factura;
CREATE VIEW vista_factura AS
SELECT 
    f.*,
    c.nombre AS cliente_nombre,
    c.direccion AS cliente_direccion,
    c.cif AS cliente_cif,
    c.vat AS cliente_vat,
    TRUNCATE (
        COALESCE(f.precio1, 0) + COALESCE(f.precio2, 0) + COALESCE(f.precio3, 0) + COALESCE(f.precio4, 0) +
        COALESCE(f.precio5, 0) + COALESCE(f.precio6, 0) + COALESCE(f.precio7, 0) + COALESCE(f.precio8, 0) +
        COALESCE(f.precio9, 0) + COALESCE(f.precio10, 0) + COALESCE(f.precio11, 0) + COALESCE(f.precio12, 0) +
        COALESCE(f.precio13, 0) + COALESCE(f.precio14, 0) + COALESCE(f.precio15, 0) + COALESCE(f.precio16, 0) +
        COALESCE(f.precio17, 0) + COALESCE(f.precio18, 0) + COALESCE(f.precio19, 0) + COALESCE(f.precio20, 0)
    , 2)
    AS total_sin_iva,
    TRUNCATE (
        (COALESCE(f.precio1, 0) + COALESCE(f.precio2, 0) + COALESCE(f.precio3, 0) + COALESCE(f.precio4, 0) +
        COALESCE(f.precio5, 0) + COALESCE(f.precio6, 0) + COALESCE(f.precio7, 0) + COALESCE(f.precio8, 0) +
        COALESCE(f.precio9, 0) + COALESCE(f.precio10, 0) + COALESCE(f.precio11, 0) + COALESCE(f.precio12, 0) +
        COALESCE(f.precio13, 0) + COALESCE(f.precio14, 0) + COALESCE(f.precio15, 0) + COALESCE(f.precio16, 0) +
        COALESCE(f.precio17, 0) + COALESCE(f.precio18, 0) + COALESCE(f.precio19, 0) + COALESCE(f.precio20, 0))
         * (1 + COALESCE(iva, 0) / 100) 
    , 2)
    AS total_con_iva
FROM factura f
JOIN cliente c ON f.cliente_id = c.id;

DROP VIEW IF EXISTS vista_factura_con_buque;
CREATE VIEW vista_factura_con_buque AS
SELECT 
    vf.*,
    fb.buque_id,
    b.nombre AS buque_nombre,
    fb.fecha_entrada,
    fb.fecha_salida
FROM 
    (vista_factura vf
    JOIN factura_con_buque fb ON vf.id = fb.id)
    JOIN buque b ON fb.buque_id = b.id;

DROP VIEW IF EXISTS vista_factura_con_dias;
CREATE VIEW vista_factura_con_dias AS
SELECT 
    vf.*,
    fd.dia1,
    fd.dia2,
    fd.dia3,
    fd.dia4,
    fd.dia5,
    fd.dia6,
    fd.dia7,
    fd.dia8,
    fd.dia9,
    fd.dia10,
    fd.dia11,
    fd.dia12,
    fd.dia13,
    fd.dia14,
    fd.dia15,
    fd.dia16,
    fd.dia17,
    fd.dia18,
    fd.dia19,
    fd.dia20
FROM vista_factura vf
JOIN factura_con_dias fd ON vf.id = fd.id;

DROP VIEW IF EXISTS vista_factura_listado;
CREATE VIEW vista_factura_listado AS
SELECT 
    vf.id, 
    vf.num_factura AS numero, 
    vf.tipo,
    vf.fecha,
    vf.cliente_nombre, 
    vf.cliente_direccion, 
    vf.cliente_cif, 
    vf.cliente_vat, 
    vfb.buque_nombre, 
    vf.iva, 
    vf.total_sin_iva, 
    vf.total_con_iva 
FROM 
    vista_factura vf 
LEFT JOIN vista_factura_con_buque vfb ON vf.id = vfb.id;
